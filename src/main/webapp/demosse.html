<!DOCTYPE html>
<html>
  <head>
    <title>TODO supply a title</title>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="manifest" href="manifest.json">     
    <script src="https://code.jquery.com/jquery-3.3.1.js"></script>      
    <script>
      $(document).ready(function () {
        if (typeof (EventSource) === "undefined") {
          alert('No SSE Support ');
          return;
        }

        var evtSource = new EventSource("sse");
        console.log('withCredentials: ' + evtSource.withCredentials);
        /*
         //console.log('readyState: ' + evtSource.readyState);
         var msg;
         switch (evtSource.readyState) {
         // if reconnecting
         case EventSource.CONNECTING:
         msg = 'Reconnecting…';
         break;
         // if error was fatal
         case EventSource.CLOSED:
         msg = 'Connection failed. Will not retry.';
         break;
         }
         console.log('msg: ' + msg);
         
         console.log('url: ' + evtSource.url);
         
         evtSource.onopen = function () {
         console.log("Connection to server opened.");
         };
         */

        evtSource.onmessage = function (e) {
          console.log("message: " + e.data);
        };

        evtSource.onerror = function (e) {
          e = e || event, msg = '';
          switch (e.target.readyState) {
            // if reconnecting
            case EventSource.CONNECTING:
              msg = 'onerror(): Reconnecting…';
              break;
              // if error was fatal
            case EventSource.CLOSED:
              //msg = 'onerror(): Connection failed. Will not retry.';
              alert('onerror(): Connection failed. Will not retry.');
              break;
          }
          //console.log('onerror(): msg: ' + msg);
        };

        //evtSource.close();
        /*
         evtSource.onerror = function () {
         console.log("EventSource failed.");
         };
         */
      }); // end ready
    </script>
  </head>
  <body>
    <div>TODO write content</div>
  </body>
</html>
